

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>COSIE.COSIE_framework.COSIE_model &mdash; COSIE 1.0, 2025-04 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/readthedocs-custom.css?v=20dd2a28" />

  
      <script src="../_static/documentation_options.js?v=59fcc1ed"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="COSIE.COSIE_framework.COSIE_model.to_device" href="COSIE.COSIE_framework.COSIE_model.to_device.html" />
    <link rel="prev" title="COSIE.COSIE_framework" href="COSIE.COSIE_framework.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="COSIE.html">COSIE</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="COSIE.COSIE_framework.html">COSIE.COSIE_framework</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">COSIE.COSIE_framework.COSIE_model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="COSIE.configure.html">COSIE.configure</a></li>
<li class="toctree-l3"><a class="reference internal" href="COSIE.data_preprocessing.html">COSIE.data_preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="COSIE.downstream_analysis.html">COSIE.downstream_analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="COSIE.image_preprocessing.html">COSIE.image_preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="COSIE.linkage_construction.html">COSIE.linkage_construction</a></li>
<li class="toctree-l3"><a class="reference internal" href="COSIE.loss.html">COSIE.loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="COSIE.model_component.html">COSIE.model_component</a></li>
<li class="toctree-l3"><a class="reference internal" href="COSIE.utils.html">COSIE.utils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">COSIE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API documentation</a></li>
          <li class="breadcrumb-item"><a href="COSIE.html">COSIE</a></li>
          <li class="breadcrumb-item"><a href="COSIE.COSIE_framework.html">COSIE.COSIE_framework</a></li>
      <li class="breadcrumb-item active">COSIE.COSIE_framework.COSIE_model</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cosie-cosie-framework-cosie-model">
<h1>COSIE.COSIE_framework.COSIE_model<a class="headerlink" href="#cosie-cosie-framework-cosie-model" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="COSIE.COSIE_framework.COSIE_model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">COSIE_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/COSIE/COSIE_framework.html#COSIE_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#COSIE.COSIE_framework.COSIE_model" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>The core model class of the COSIE framework, designed for spatial multimodal integration, imputation, and enhancement across multiple tissue sections. This class defines the model structure, and handles both training and inference in full-graph or subgraph settings.</p>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>config<span class="classifier">dict</span></dt><dd><p>Configuration dictionary defining architecture and training hyperparameters.
Includes sub-configs for GraphAutoencoder, Prediction modules, and training settings.
This can be customized in configure script.</p>
</dd>
<dt>feature_dict<span class="classifier">dict</span></dt><dd><p>A dictionary mapping section names (e.g., <cite>‘s1’</cite>, <cite>‘s2’</cite>) to a sub-dictionary of processed feature tensors for each modality (as <cite>torch.FloatTensor</cite>). 
Format:
{‘s1’: {‘RNA’: tensor[n_cells, d], ‘Protein’: tensor[n_cells, d], …},’s2’: {…}, …}</p>
</dd>
</dl>
</section>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>autoencoders<span class="classifier">nn.ModuleDict</span></dt><dd><p>Dictionary of GraphAutoencoder models per modality.</p>
</dd>
<dt>predictors<span class="classifier">nn.ModuleDict</span></dt><dd><p>Dictionary of Prediction modules for all available modality pairs.</p>
</dd>
<dt>triplet_loss_fn<span class="classifier">torch.nn.TripletMarginLoss</span></dt><dd><p>Loss function used for cross-section integration.</p>
</dd>
<dt>latent_dim<span class="classifier">int</span></dt><dd><p>Embedding dimension.</p>
</dd>
<dt>all_modalities<span class="classifier">list</span></dt><dd><p>List of all detected modalities across sections.</p>
</dd>
</dl>
</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>to_device()</dt><dd><p>Move the entire model, including all submodules, to a specified device.</p>
</dd>
<dt>train_model()</dt><dd><p>Train the model on either the full graph or spatially partitioned subgraphs, depending on the <cite>n_x</cite> and <cite>n_y</cite> grid splits.</p>
</dd>
</dl>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="COSIE.COSIE_framework.COSIE_model.to_device.html#COSIE.COSIE_framework.COSIE_model.to_device" title="COSIE.COSIE_framework.COSIE_model.to_device"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_device</span></code></a></p></td>
<td><p>Move all model parameters and submodules to the specified device.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="COSIE.COSIE_framework.COSIE_model.train_model.html#COSIE.COSIE_framework.COSIE_model.train_model" title="COSIE.COSIE_framework.COSIE_model.train_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_model</span></code></a></p></td>
<td><p>Train the COSIE model on spatial multimodal data.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
</tbody>
</table>
</section>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="COSIE.COSIE_framework.html" class="btn btn-neutral float-left" title="COSIE.COSIE_framework" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="COSIE.COSIE_framework.COSIE_model.to_device.html" class="btn btn-neutral float-right" title="COSIE.COSIE_framework.COSIE_model.to_device" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Mingyao Li Lab, 2025.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>